(function(d){d.fn.extend({tableExport:function(h){function u(l){!0===a.consoleLog&&console.log(l.output());if("string"==a.outputMode)return l.output();if("base64"==a.outputMode)return n(l.output());try{var d=l.output("blob");saveAs(d,a.fileName+".pdf")}catch(b){p(a.fileName+".pdf","data:application/pdf;base64,"+n(l.output()))}}function v(l,d,b){var c="";d=k(l,d,b);l=null===d||""==d?"":d.toString();if(d instanceof Date)c=a.csvEnclosure+d.toLocaleString()+a.csvEnclosure;else if(d=a.csvEnclosure+a.csvEnclosure,
c=l.replace(new RegExp(a.csvEnclosure.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1"),"g"),d),0<=c.indexOf(a.csvSeparator)||/[\r\n ]/g.test(c))c=a.csvEnclosure+c+a.csvEnclosure;return c}function k(l,b,c){l=d(l);content_data=!0===a.htmlContent?l.html().trim():l.text().trim().replace(/\u00AD/g,"");!0===a.escape&&(content_data=escape(content_data));"function"===typeof a.onCellData&&(content_data=a.onCellData(l,b,c,content_data));return content_data}function C(a,d,b){return d+"-"+b.toLowerCase()}function w(a,
d,b){window.getComputedStyle?(d=d.replace(/([a-z])([A-Z])/,C),d=window.getComputedStyle(a,null).getPropertyValue(d)):d=a.currentStyle?a.currentStyle[d]:a.style[d];d=d.match(/\d+/);if(null!==d){d=d[0];var c=document.createElement("div");c.style.overflow="hidden";c.style.visibility="hidden";a.parentElement.appendChild(c);c.style.width=100+b;b=100/c.offsetWidth;a.parentElement.removeChild(c);return d*b}return 0}function p(a,d){var b=document.createElement("a");if(b){document.body.appendChild(b);b.style=
"display: none";b.download=a;b.href=d;if(document.createEvent)null==q&&(q=document.createEvent("MouseEvents")),q.initEvent("click",!0,!1),b.dispatchEvent(q);else if(document.createEventObject)b.fireEvent("onclick");else if("function"==typeof b.onclick)b.onclick();document.body.removeChild(b)}}function n(a){var d="",b,c,e,f,g,h,k=0;a=a.replace(/\x0d\x0a/g,"\n");c="";for(e=0;e<a.length;e++)f=a.charCodeAt(e),128>f?c+=String.fromCharCode(f):(127<f&&2048>f?c+=String.fromCharCode(f>>6|192):(c+=String.fromCharCode(f>>
12|224),c+=String.fromCharCode(f>>6&63|128)),c+=String.fromCharCode(f&63|128));for(a=c;k<a.length;)b=a.charCodeAt(k++),c=a.charCodeAt(k++),e=a.charCodeAt(k++),f=b>>2,b=(b&3)<<4|c>>4,g=(c&15)<<2|e>>6,h=e&63,isNaN(c)?g=h=64:isNaN(e)&&(h=64),d=d+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(f)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(b)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(g)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(h);
return d}var a={csvSeparator:",",csvEnclosure:'"',onCellData:null,ignoreColumn:[],displayTableName:!1,theadSelector:"tr",tbodySelector:"tr",tableName:"myTableName",worksheetName:"xlsWorksheetName",type:"csv",jspdf:{orientation:"p",unit:"pt",format:"a4",margins:{left:20,right:10,top:10,bottom:10},autotable:{padding:2,lineHeight:12,fontSize:8}},escape:!1,htmlContent:!1,consoleLog:!1,outputMode:"file",fileName:"tableExport",excelstyles:["border-bottom","border-top","border-left","border-right"]};h=d.extend(!0,
a,h);var q=null;if("csv"==a.type||"txt"==a.type){var c="",f=0;d(this).find("thead").find(a.theadSelector).each(function(){c+="\n";d(this).filter(":visible").find("th").each(function(b,e){"none"!=d(this).css("display")&&"none"!=d(this).data("tableexport-display")&&-1==a.ignoreColumn.indexOf(b)&&(c+=v(this,f,b)+a.csvSeparator)});f++;c=d.trim(c);c=d.trim(c).substring(0,c.length-1)});d(this).find("tbody").find(a.tbodySelector).each(function(){c+="\n";d(this).filter(":visible").find("td").each(function(b,
e){"none"!=d(this).css("display")&&"none"!=d(this).data("tableexport-display")&&-1==a.ignoreColumn.indexOf(b)&&(c+=v(this,f,b)+a.csvSeparator)});f++;c=d.trim(c).substring(0,c.length-1)});!0===a.consoleLog&&console.log(c);if("string"==a.outputMode)return c;if("base64"==a.outputMode)return n(c);try{var m=new Blob([("csv"==a.type?"\ufeff":"")+c],{type:"text/"+("csv"==a.type?"csv":"plain")+";charset=utf-8"});saveAs(m,a.fileName+"."+a.type)}catch(D){p(a.fileName+"."+a.type,"data:text/"+("csv"==a.type?
"csv":"plain")+";charset=utf-8,"+("csv"==a.type?"\ufeff":"")+encodeURIComponent(c))}}else if("sql"==a.type){f=0;c="INSERT INTO `"+a.tableName+"` (";d(this).find("thead").find(a.theadSelector).each(function(){d(this).filter(":visible").find("th").each(function(b,e){"none"!=d(this).css("display")&&"none"!=d(this).data("tableexport-display")&&-1==a.ignoreColumn.indexOf(b)&&(c+="'"+k(this,f,b)+"',")});f++;c=d.trim(c);c=d.trim(c).substring(0,c.length-1)});c+=") VALUES ";d(this).find("tbody").find(a.tbodySelector).each(function(){c+=
"(";d(this).filter(":visible").find("td").each(function(b,e){"none"!=d(this).css("display")&&"none"!=d(this).data("tableexport-display")&&-1==a.ignoreColumn.indexOf(b)&&(c+="'"+k(this,f,b)+"',")});f++;c=d.trim(c).substring(0,c.length-1);c+="),"});c=d.trim(c).substring(0,c.length-1);c+=";";!0===a.consoleLog&&console.log(c);if("string"==a.outputMode)return c;if("base64"==a.outputMode)return n(c);try{m=new Blob([c],{type:"text/plain;charset=utf-8"}),saveAs(m,a.fileName+".sql")}catch(E){p(a.fileName+
".sql","data:application/sql;charset=utf-8,"+encodeURIComponent(c))}}else if("json"==a.type){var x=[];d(this).find("thead").find(a.theadSelector).each(function(){var b=[],c=0;d(this).filter(":visible").find("th").each(function(e,f){"none"!=d(this).css("display")&&"none"!=d(this).data("tableexport-display")&&-1==a.ignoreColumn.indexOf(e)&&b.push(k(this,c,e))});c++;x.push(b)});var y=[];d(this).find("tbody").find(a.tbodySelector).each(function(){var b=[];d(this).filter(":visible").find("td").each(function(c,
e){"none"!=d(this).css("display")&&"none"!=d(this).data("tableexport-display")&&-1==a.ignoreColumn.indexOf(c)&&b.push(k(this,f,c))});f++;y.push(b)});h=[];h.push({header:x,data:y});var b=JSON.stringify(h);!0===a.consoleLog&&console.log(b);if("string"==a.outputMode)return b;h=n(b);if("base64"==a.outputMode)return h;try{m=new Blob([b],{type:"application/json;charset=utf-8"}),saveAs(m,a.fileName+".json")}catch(F){p(a.fileName+".json","data:application/json;charset=utf-8;base64,"+h)}}else if("xml"==a.type){var f=
0,g='<?xml version="1.0" encoding="utf-8"?>',g=g+"<tabledata><fields>";d(this).find("thead").find(a.theadSelector).each(function(){d(this).filter(":visible").find("th").each(function(b,c){"none"!=d(this).css("display")&&"none"!=d(this).data("tableexport-display")&&-1==a.ignoreColumn.indexOf(b)&&(g+="<field>"+k(this,f,b)+"</field>")});f++});var g=g+"</fields><data>",r=1;d(this).find("tbody").find(a.tbodySelector).each(function(){g+='<row id="'+r+'">';var b=0;d(this).filter(":visible").find("td").each(function(c,
e){"none"!=d(this).css("display")&&"none"!=d(this).data("tableexport-display")&&-1==a.ignoreColumn.indexOf(c)&&(g+="<column-"+b+">"+k(this,f,c)+"</column-"+b+">");b++});r++;f++;g+="</row>"});g+="</data></tabledata>";!0===a.consoleLog&&console.log(g);if("string"==a.outputMode)return g;h=n(g);if("base64"==a.outputMode)return h;try{m=new Blob([g],{type:"application/xml;charset=utf-8"}),saveAs(m,a.fileName+".xml")}catch(G){p(a.fileName+".xml","data:application/xml;charset=utf-8;base64,"+h)}}else if("excel"==
a.type||"doc"==a.type){var f=0,e="<table>";d(this).find("thead").find(a.theadSelector).each(function(){e+="<tr>";d(this).filter(":visible").find("th,td").each(function(b,c){if("none"!=d(this).css("display")&&"none"!=d(this).data("tableexport-display")&&-1==a.ignoreColumn.indexOf(b)){e+="<td style='";for(var g in a.excelstyles)a.excelstyles.hasOwnProperty(g)&&(e+=a.excelstyles[g]+": "+d(this).css(a.excelstyles[g])+";");e+="'>"+k(this,f,b)+"</td>"}});f++;e+="</tr>"});r=1;d(this).find("tbody").find(a.tbodySelector).each(function(){e+=
"<tr>";var b=0;d(this).filter(":visible").find("td").each(function(c,g){if("none"!=d(this).css("display")&&"none"!=d(this).data("tableexport-display")&&-1==a.ignoreColumn.indexOf(c)){e+="<td style='";for(var h in a.excelstyles)a.excelstyles.hasOwnProperty(h)&&(e+=a.excelstyles[h]+": "+d(this).css(a.excelstyles[h])+";");d(this).is("[colspan]")&&(e+="' colspan='"+d(this).attr("colspan"));e+="'>"+k(this,f,c)+"</td>"}b++});r++;f++;e+="</tr>"});a.displayTableName&&(e+="<tr><td></td></tr><tr><td></td></tr><tr><td>"+
k(d("<p>"+a.tableName+"</p>"))+"</td></tr>");e+="</table>";!0===a.consoleLog&&console.log(e);b="<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:x='urn:schemas-microsoft-com:office:"+a.type+"' xmlns='http://www.w3.org/TR/REC-html40'>";b+='<meta http-equiv="content-type" content="application/vnd.ms-'+a.type+'; charset=UTF-8">';b=b+'<meta http-equiv="content-type" content="application/'+("excel"==a.type?"vnd.ms-excel":"msword");b+='; charset=UTF-8">';b+="<head>";"excel"==a.type&&(b+="\x3c!--[if gte mso 9]>",
b+="<xml>",b+="<x:ExcelWorkbook>",b+="<x:ExcelWorksheets>",b+="<x:ExcelWorksheet>",b+="<x:Name>",b+=a.worksheetName,b+="</x:Name>",b+="<x:WorksheetOptions>",b+="<x:DisplayGridlines/>",b+="</x:WorksheetOptions>",b+="</x:ExcelWorksheet>",b+="</x:ExcelWorksheets>",b+="</x:ExcelWorkbook>",b+="</xml>",b+="<![endif]--\x3e");b+="</head>";b+="<body>";b+=e;b+="</body>";b+="</html>";if("string"==a.outputMode)return b;h=n(b);if("base64"==a.outputMode)return h;var z="excel"==a.type?"xls":"doc";try{m=new Blob([b],
{type:"application/vnd.ms-"+a.type}),saveAs(m,a.fileName+"."+z)}catch(H){p(a.fileName+"."+z,"data:application/vnd.ms-"+a.type+";base64,"+h)}}else if("png"==a.type)html2canvas(d(this),{onrendered:function(b){b=b.toDataURL();b=b.substring(22);for(var d=atob(b),c=new ArrayBuffer(d.length),e=new Uint8Array(c),f=0;f<d.length;f++)e[f]=d.charCodeAt(f);try{var g=new Blob([c],{type:"image/png"});saveAs(g,a.fileName+".png")}catch(h){p(a.fileName+".png","data:image/png;base64,"+b)}}});else if("pdf"==a.type){var t=
new jsPDF(a.jspdf.orientation,a.jspdf.unit,a.jspdf.format);if(!1===a.jspdf.autotable)h={dim:{w:w(d(this).get(0),"width","mm"),h:w(d(this).get(0),"height","mm")}},t.addHTML(d(this),a.jspdf.margins.left,a.jspdf.margins.top,h,function(){u(t)});else{var A=[];d(this).find("thead").find(a.theadSelector).each(function(){var b=0;d(this).filter(":visible").find("th").each(function(c,e){"none"!=d(this).css("display")&&"none"!=d(this).data("tableexport-display")&&-1==a.ignoreColumn.indexOf(c)&&A.push(k(this,
b,c))});b++});var B=[];d(this).find("tbody").find(a.tbodySelector).each(function(){var b=[];d(this).filter(":visible").find("td").each(function(c,e){"none"!=d(this).css("display")&&"none"!=d(this).data("tableexport-display")&&-1==a.ignoreColumn.indexOf(c)&&b.push(k(this,f,c))});f++;B.push(b)});a.jspdf.autotable.margins={};d.extend(!0,a.jspdf.autotable.margins,a.jspdf.margins);t.autoTable(A,B,a.jspdf.autotable);u(t)}}}})})(jQuery);
